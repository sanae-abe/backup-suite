# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¬ã‚¤ãƒ‰ - backup-suite

## ğŸ“‹ æ¦‚è¦

backup-suiteã®ãƒ†ã‚¹ãƒˆåŸºç›¤ã¯ä»¥ä¸‹ã®3ã¤ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™:

1. **çµ±åˆãƒ†ã‚¹ãƒˆ** - ãƒ•ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³ã€å„ªå…ˆåº¦ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
2. **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ** - ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«å¯¾ç­–ã€ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ã®ä¸€è²«æ€§æ¤œè¨¼
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯** - å®Ÿè¡Œé€Ÿåº¦ã¨ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£æ¸¬å®š

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
cargo test

# çµ±åˆãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ
cargo test --test integration_tests

# ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ
cargo test --test proptest

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ
cargo test --test security_tests

# ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯å®Ÿè¡Œ
cargo bench
```

### ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š

```bash
# cargo-tarpaulinã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆåˆå›ã®ã¿ï¼‰
cargo install cargo-tarpaulin

# ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š
cargo tarpaulin --out Html --output-dir coverage

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚’é–‹ã
open coverage/index.html
```

---

## ğŸ“Š ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™

### ç¾åœ¨ã®ç›®æ¨™ï¼ˆPhase 2ï¼‰

| ã‚«ãƒ†ã‚´ãƒª | ç¾åœ¨ | ç›®æ¨™ | å®Œäº†æ¡ä»¶ |
|---------|------|------|----------|
| **å…¨ä½“ã‚«ãƒãƒ¬ãƒƒã‚¸** | 30% | 80% | Phase 2å®Œäº†æ™‚ |
| **ã‚³ã‚¢æ©Ÿèƒ½** | 40% | 90% | Phase 2å®Œäº†æ™‚ |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£** | 20% | 95% | Phase 1å®Œäº†æ™‚ |
| **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** | 35% | 85% | Phase 2å®Œäº†æ™‚ |

### ã‚«ãƒãƒ¬ãƒƒã‚¸ç¢ºèªã‚³ãƒãƒ³ãƒ‰

```bash
# JSONå½¢å¼ã§è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›
cargo tarpaulin --out Json | jq '.files | to_entries | map({file: .key, coverage: .value.coverage})'

# é–¾å€¤ãƒã‚§ãƒƒã‚¯ï¼ˆ60%æœªæº€ã§ã‚¨ãƒ©ãƒ¼ï¼‰
coverage=$(cargo tarpaulin --out Json | jq '.files | to_entries | map(.value.coverage) | add / length')
if (( $(echo "$coverage < 60" | bc -l) )); then
    echo "Coverage ${coverage}% is below threshold 60%"
    exit 1
fi
```

---

## ğŸ§ª çµ±åˆãƒ†ã‚¹ãƒˆè©³ç´°

### ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆæ§‹æˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `tests/integration_tests.rs`

#### ä¸»è¦ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

1. **ãƒ•ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**
   - å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
   - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®å†ç¾æ€§
   - ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã®æ•´åˆæ€§

2. **é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**
   - æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
   - è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ã®çµ„ã¿åˆã‚ã›
   - éš ã—ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»node_modulesé™¤å¤–

3. **å„ªå…ˆåº¦åˆ¥ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**
   - High/Medium/Low ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
   - å„ªå…ˆåº¦ã®åŒ…å«é–¢ä¿‚æ¤œè¨¼

4. **è¨­å®šã®æ°¸ç¶šåŒ–**
   - TOML ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º/ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º
   - è¨­å®šãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

5. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
   - å­˜åœ¨ã—ãªã„ãƒ‘ã‚¹ã®å‡¦ç†
   - æ¨©é™ã‚¨ãƒ©ãƒ¼ã®é©åˆ‡ãªå‡¦ç†

### å®Ÿè¡Œä¾‹

```bash
# å…¨çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
cargo test --test integration_tests

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ
cargo test --test integration_tests test_full_backup_workflow_single_file

# è©³ç´°å‡ºåŠ›
cargo test --test integration_tests -- --nocapture

# ä¸¦åˆ—å®Ÿè¡Œç„¡åŠ¹åŒ–ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
cargo test --test integration_tests -- --test-threads=1
```

---

## ğŸ”¬ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆè©³ç´°

### ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆæ§‹æˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `tests/proptest.rs`

ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆã¯ã€å¤§é‡ã®ãƒ©ãƒ³ãƒ€ãƒ å…¥åŠ›ã§ä¸å¤‰æ¡ä»¶ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚

#### æ¤œè¨¼ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£

1. **ãƒ‘ã‚¹æ“ä½œã®å®‰å…¨æ€§**
   - ãƒ‘ã‚¹çµåˆæ™‚ã®ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚¨ã‚¹ã‚±ãƒ¼ãƒ—é˜²æ­¢
   - å±é™ºãªãƒ‘ã‚¹è¦ç´ ï¼ˆ`..`ï¼‰ã®æ¤œå‡º
   - ãƒ‘ã‚¹æ­£è¦åŒ–ã®ä¸€è²«æ€§

2. **ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã®å†ªç­‰æ€§**
   - ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ”ãƒ¼ã®å†ç¾æ€§
   - ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã®ä¸€è²«æ€§
   - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªèµ°æŸ»ã®å®Œå…¨æ€§

3. **è¨­å®šã®ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå¯é€†æ€§**
   - TOMLå¤‰æ›ã®æƒ…å ±æå¤±ãªã—
   - å¢ƒç•Œå€¤ã®é©åˆ‡ãªå‡¦ç†

4. **é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸€è²«æ€§**
   - æ­£è¦è¡¨ç¾ã®å¦¥å½“æ€§
   - ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã®è«–ç†çš„æ•´åˆæ€§

5. **ä¸¦åˆ—å‡¦ç†ã®å®‰å…¨æ€§**
   - åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ã§ã®ãƒ‡ãƒ¼ã‚¿ç«¶åˆãªã—
   - ã‚¹ãƒ¬ãƒƒãƒ‰å®‰å…¨æ€§ã®æ¤œè¨¼

### å®Ÿè¡Œä¾‹

```bash
# å…¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
cargo test --test proptest

# ã‚±ãƒ¼ã‚¹æ•°ã‚’å¢—ã‚„ã—ã¦å®Ÿè¡Œï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ256ã‚±ãƒ¼ã‚¹ï¼‰
PROPTEST_CASES=1000 cargo test --test proptest

# å¤±æ•—ã‚±ãƒ¼ã‚¹ã®å†ç¾
cargo test --test proptest -- --nocapture

# ç‰¹å®šã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ã¿ãƒ†ã‚¹ãƒˆ
cargo test --test proptest test_path_joining_never_escapes_base
```

### ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

å¤±æ•—ã—ãŸã‚±ãƒ¼ã‚¹ã¯è‡ªå‹•çš„ã«è¨˜éŒ²ã•ã‚Œã€å†ç¾å¯èƒ½ã§ã™:

```bash
# proptest-regressions/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¤±æ•—ã‚±ãƒ¼ã‚¹ãŒä¿å­˜ã•ã‚Œã‚‹
ls proptest-regressions/

# ç‰¹å®šã®å¤±æ•—ã‚±ãƒ¼ã‚¹ã‚’å†å®Ÿè¡Œ
cargo test --test proptest -- --ignored
```

---

## âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è©³ç´°

### ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯æ§‹æˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `benches/backup_benchmark.rs`

#### æ¸¬å®šé …ç›®

1. **å°ã•ãªãƒ•ã‚¡ã‚¤ãƒ«** - 10/50/100/500ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ
2. **å¤§ããªãƒ•ã‚¡ã‚¤ãƒ«** - 1MB/5MB/10MBã®ã‚³ãƒ”ãƒ¼é€Ÿåº¦
3. **ãƒã‚¹ãƒˆã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª** - æ·±ã•2/3/4ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªèµ°æŸ»
4. **ä¸¦åˆ—å‡¦ç†ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£** - 100/500/1000ãƒ•ã‚¡ã‚¤ãƒ«ã§ã®ä¸¦åˆ—åŠ¹ç‡
5. **å„ªå…ˆåº¦ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°** - ãƒ•ã‚£ãƒ«ã‚¿ã‚ã‚Š/ãªã—ã®æ¯”è¼ƒ
6. **è¨­å®šæ“ä½œ** - ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º/ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºé€Ÿåº¦
7. **ãƒ•ã‚¡ã‚¤ãƒ«åé›†** - walkdirã®åŠ¹ç‡
8. **é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°** - æ­£è¦è¡¨ç¾ãƒãƒƒãƒãƒ³ã‚°é€Ÿåº¦

### å®Ÿè¡Œä¾‹

```bash
# å…¨ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯å®Ÿè¡Œ
cargo bench

# ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã¨ã—ã¦ä¿å­˜
cargo bench -- --save-baseline baseline

# æœ€é©åŒ–å¾Œã«æ¯”è¼ƒ
cargo bench -- --baseline baseline

# ç‰¹å®šã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã®ã¿å®Ÿè¡Œ
cargo bench -- small_files

# HTML ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
cargo bench
open target/criterion/report/index.html
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™

| é …ç›® | ç¾åœ¨ | ç›®æ¨™ | Phase |
|------|------|------|-------|
| 100ãƒ•ã‚¡ã‚¤ãƒ« | 0.84s | 0.5sä»¥ä¸‹ | Phase 3 |
| 10MBãƒ•ã‚¡ã‚¤ãƒ« | 1.2s | 1.0sä»¥ä¸‹ | Phase 3 |
| ä¸¦åˆ—åŠ¹ç‡ | 70% | 85%ä»¥ä¸Š | Phase 3 |
| ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ | 12MB | 15MBä»¥ä¸‹ | Phase 3 |

---

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆæ§‹æˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `tests/security_tests.rs`

#### æ¤œè¨¼é …ç›®

1. **ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«å¯¾ç­–**
   - `../` ã‚’å«ã‚€ãƒ‘ã‚¹ã®æ¤œè¨¼
   - çµ¶å¯¾ãƒ‘ã‚¹æ”»æ’ƒã®é˜²æ­¢

2. **æ¨©é™ãƒã‚§ãƒƒã‚¯**
   - èª­ã¿å–ã‚Šæ¨©é™ã®æ¤œè¨¼
   - æ›¸ãè¾¼ã¿æ¨©é™ã®æ¤œè¨¼

3. **å…¥åŠ›ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³**
   - ä¸æ­£ãªãƒ•ã‚¡ã‚¤ãƒ«åã®å‡¦ç†
   - ç‰¹æ®Šæ–‡å­—ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—

### å®Ÿè¡Œä¾‹

```bash
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
cargo test --test security_tests

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ
cargo install cargo-audit
cargo audit

# ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯
cargo install cargo-deny
cargo deny check
```

---

## ğŸ¤– CI/CDçµ±åˆ

### GitHub Actionsè¨­å®š

**ãƒ•ã‚¡ã‚¤ãƒ«**: `.github/workflows/ci.yml`

#### å®Ÿè¡Œã‚¸ãƒ§ãƒ–

1. **format** - ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯ (`cargo fmt`)
2. **clippy** - é™çš„è§£æ (`cargo clippy`)
3. **test** - å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆè¤‡æ•°OSãƒ»Rustãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰
4. **coverage** - ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®šãƒ»codecovã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
5. **security-audit** - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ» (`cargo audit`)
6. **benchmark** - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šï¼ˆmainãƒ–ãƒ©ãƒ³ãƒã®ã¿ï¼‰
7. **build-release** - ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ï¼ˆã‚¿ã‚°æ™‚ã®ã¿ï¼‰
8. **docs** - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆãƒ»GitHub Pageså…¬é–‹

### ãƒ­ãƒ¼ã‚«ãƒ«ã§CIç›¸å½“ã®æ¤œè¨¼

```bash
# ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯
cargo fmt -- --check

# Clippy
cargo clippy --all-targets --all-features -- -D warnings

# å…¨ãƒ†ã‚¹ãƒˆ
cargo test --verbose

# ã‚«ãƒãƒ¬ãƒƒã‚¸
cargo tarpaulin --out Xml

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»
cargo audit

# ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯
cargo bench
```

### CIçµæœã®ç¢ºèª

- **ãƒ†ã‚¹ãƒˆçµæœ**: GitHub Actions ã® Summary ã‚¿ãƒ–
- **ã‚«ãƒãƒ¬ãƒƒã‚¸**: codecov.io ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- **ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯**: GitHub Pages ã® Criterion ãƒ¬ãƒãƒ¼ãƒˆ
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://yourusername.github.io/backup-suite/

---

## ğŸ“– ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£

### å…±é€šãƒ†ã‚¹ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼

**ãƒ•ã‚¡ã‚¤ãƒ«**: `tests/common/mod.rs`

#### æä¾›æ©Ÿèƒ½

1. **TestEnvironment** - ãƒ†ã‚¹ãƒˆç”¨ã®ä¸€æ™‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç®¡ç†
2. **create_sample_directory_structure** - ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
3. **create_large_directory** - å¤§é‡ãƒ•ã‚¡ã‚¤ãƒ«ã®ç”Ÿæˆ
4. **create_mixed_extension_files** - æ§˜ã€…ãªæ‹¡å¼µå­ã®ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
5. **verify_file_integrity** - ãƒ•ã‚¡ã‚¤ãƒ«æ•´åˆæ€§æ¤œè¨¼
6. **debug_directory_structure** - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›

#### ä½¿ç”¨ä¾‹

```rust
use crate::common::*;

#[test]
fn my_test() -> Result<()> {
    // ãƒ†ã‚¹ãƒˆç’°å¢ƒä½œæˆ
    let env = TestEnvironment::new()?;

    // ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
    env.create_file("test.txt", "content")?;

    // ã‚µãƒ³ãƒ—ãƒ«æ§‹é€ ä½œæˆ
    create_sample_directory_structure(&env)?;

    // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Ÿè¡Œ
    let config = env.create_config_with_target(
        env.source_path(),
        Priority::High,
        "test"
    );

    let result = backup_suite::core::backup::run_backup(&config, None)?;

    // æ¤œè¨¼
    assert_eq!(env.count_backup_files(&result.backup_name)?, 5);

    Ok(())
}
```

---

## ğŸ¯ ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### Phaseåˆ¥ãƒ†ã‚¹ãƒˆå¼·åŒ–è¨ˆç”»

#### Phase 1: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå¼·åŒ–ï¼ˆWeek 1ï¼‰
- [ ] ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«é˜²æ­¢ãƒ†ã‚¹ãƒˆè¿½åŠ 
- [ ] æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒ†ã‚¹ãƒˆè¿½åŠ 
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆè¿½åŠ 
- **ç›®æ¨™ã‚«ãƒãƒ¬ãƒƒã‚¸**: 60%

#### Phase 2: æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆå®Œæˆï¼ˆWeek 2-3ï¼‰
- [ ] exclude_patterns ãƒ†ã‚¹ãƒˆè¿½åŠ 
- [ ] è¨­å®šãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆè¿½åŠ 
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆæ‹¡å……
- **ç›®æ¨™ã‚«ãƒãƒ¬ãƒƒã‚¸**: 80%

#### Phase 3: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆWeek 4-5ï¼‰
- [ ] ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯åŸºæº–å€¤è¨­å®š
- [ ] ä¸¦åˆ—å‡¦ç†åŠ¹ç‡æ¸¬å®š
- [ ] ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°
- **ç›®æ¨™**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹20%å‘ä¸Š

---

## ğŸ› ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹

```bash
# è©³ç´°ãƒ­ã‚°ã§åŸå› ç‰¹å®š
RUST_LOG=debug cargo test -- --nocapture

# å˜ä½“ã§å®Ÿè¡Œã—ã¦éš”é›¢
cargo test test_name -- --exact
```

#### ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒæ¸¬å®šã§ããªã„

```bash
# tarpaulinã®å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
cargo install cargo-tarpaulin --force

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
cargo clean
```

#### ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãŒä¸å®‰å®š

```bash
# ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã‚’å¢—ã‚„ã™
cargo bench -- --sample-size 100

# ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—æ™‚é–“ã‚’å¢—ã‚„ã™
cargo bench -- --warm-up-time 5
```

---

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [Rust ãƒ†ã‚¹ãƒˆã®æ›¸ãæ–¹](https://doc.rust-lang.org/book/ch11-00-testing.html)
- [proptest ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.rs/proptest/)
- [Criterion ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯](https://bheisler.github.io/criterion.rs/book/)
- [cargo-tarpaulin](https://github.com/xd009642/tarpaulin)

---

## âœ… ä»Šã™ãã§ãã‚‹ã“ã¨

### ãƒ†ã‚¹ãƒˆåŸºç›¤ã®å‹•ä½œç¢ºèªï¼ˆ5åˆ†ï¼‰

```bash
# 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd ~/projects/backup-suite

# 2. ä¾å­˜é–¢ä¿‚ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
cargo build

# 3. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
cargo test

# 4. ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®šï¼ˆtarpaulinã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã®å ´åˆï¼‰
cargo tarpaulin --out Html

# 5. ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯å®Ÿè¡Œ
cargo bench
```

### CI/CDã®æœ‰åŠ¹åŒ–ï¼ˆGitHubï¼‰

1. ãƒªãƒã‚¸ãƒˆãƒªã‚’GitHubã«ãƒ—ãƒƒã‚·ãƒ¥
2. `.github/workflows/ci.yml` ãŒè‡ªå‹•èªè­˜ã•ã‚Œã‚‹
3. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•å®Ÿè¡Œ

---

**ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%é”æˆå¯èƒ½ãªå¼·å›ºãªåŸºç›¤ãŒå®Œæˆã—ã¾ã—ãŸï¼**
