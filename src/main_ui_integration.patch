/// main.rsã¸ã®UIçµ±åˆãƒ‘ãƒƒãƒ
/// ä»¥ä¸‹ã®ã‚³ãƒžãƒ³ãƒ‰ã‚’æ–°ã—ã„UIæ©Ÿèƒ½ã§ç½®ãæ›ãˆã‚‹

// ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«è¿½åŠ 
use backup_suite::ui::{display_dashboard, display_targets, display_history, display_backup_result, ColorTheme};

// Commands::List ã®å®Ÿè£…ã‚’ç½®ãæ›ãˆï¼ˆè¡Œ619-641ï¼‰
Some(Commands::List { priority }) => {
    let config = Config::load()?;
    let theme = ColorTheme::auto();

    let targets = if let Some(p) = priority {
        let prio = parse_priority(&p)?;
        config.filter_by_priority(&prio)
    } else {
        config.targets.iter().collect()
    };

    display_targets(&targets.iter().map(|&t| t.clone()).collect::<Vec<_>>(), &theme);
}

// Commands::Run ã®çµæžœè¡¨ç¤ºã‚’ç½®ãæ›ãˆï¼ˆè¡Œ681-698ï¼‰
Some(Commands::Run { priority, dry_run }) => {
    let priority = priority.as_ref().map(|s| parse_priority(s)).transpose()?;
    let config = Config::load()?;
    let theme = ColorTheme::auto();

    println!("{}ðŸš€ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Ÿè¡Œ{}{}",
        get_color("green"),
        if dry_run { "ï¼ˆãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼‰" } else { "" },
        get_color("reset"));

    let runner = BackupRunner::new(config, dry_run);
    let result = runner.run(priority.as_ref())?;

    if !dry_run {
        display_backup_result(
            result.total_files,
            result.success_files,
            result.failed_files,
            result.total_bytes,
            &theme,
        );

        if !result.errors.is_empty() {
            println!("\n{}âš ï¸ ã‚¨ãƒ©ãƒ¼è©³ç´°{}", get_color("yellow"), get_color("reset"));
            for (i, error) in result.errors.iter().enumerate() {
                println!("  {}. {}", i + 1, error);
            }
        }
    } else {
        println!("{}ðŸ“‹ æ¤œå‡º{}: {} ãƒ•ã‚¡ã‚¤ãƒ«",
            get_color("gray"), get_color("reset"), result.total_files);
    }
}

// Commands::History ã®å®Ÿè£…ã‚’ç½®ãæ›ãˆï¼ˆè¡Œ750-767ï¼‰
Some(Commands::History { days }) => {
    let history = BackupHistory::filter_by_days(days)?;
    let theme = ColorTheme::auto();

    println!("\n{}ðŸ“œ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å±¥æ­´{}ï¼ˆ{}æ—¥é–“ï¼‰",
        get_color("magenta"), get_color("reset"), days);

    display_history(&history, &theme);
}

// Commands::Dashboard ã®å®Ÿè£…ã‚’ç½®ãæ›ãˆï¼ˆè¡Œ782-804ï¼‰
Some(Commands::Dashboard) => {
    display_dashboard()?;
}
